# ==============================================================================
# LOGROTATE CONFIGURATION FOR REPAIRMYBIKE APPLICATION
# ==============================================================================

# Global options
compress
delaycompress
missingok
notifempty
create 644 django django

# Django application logs
/app/logs/*.log {
    daily
    rotate 30
    size 100M
    compress
    delaycompress
    missingok
    notifempty
    create 644 django django
    postrotate
        # Send SIGUSR1 to Django process to reopen log files
        # This assumes you're using a proper logging setup
        /bin/kill -USR1 $(cat /tmp/django.pid 2>/dev/null) 2>/dev/null || true
    endscript
}

# Nginx logs (if running in the same container)
/var/log/nginx/*.log {
    daily
    rotate 30
    size 100M
    compress
    delaycompress
    missingok
    notifempty
    create 644 nginx nginx
    postrotate
        /bin/kill -USR1 $(cat /var/run/nginx.pid 2>/dev/null) 2>/dev/null || true
    endscript
}

# System logs
/var/log/messages {
    weekly
    rotate 4
    compress
    delaycompress
    missingok
    notifempty
}

/var/log/secure {
    weekly
    rotate 4
    compress
    delaycompress
    missingok
    notifempty
}